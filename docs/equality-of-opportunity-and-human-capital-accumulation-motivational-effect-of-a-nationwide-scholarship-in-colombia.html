<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.1 Equality of opportunity and human capital accumulation: Motivational effect of a nationwide scholarship in Colombia | bookdownproj.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="4.1 Equality of opportunity and human capital accumulation: Motivational effect of a nationwide scholarship in Colombia | bookdownproj.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.1 Equality of opportunity and human capital accumulation: Motivational effect of a nationwide scholarship in Colombia | bookdownproj.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="differences-in-discontinuity-design.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/font-awesome-5.13.0/js/script.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">M2-Econometrics-Book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome to our replication textbook!</a></li>
<li class="chapter" data-level="1" data-path="randomized-control-trials.html"><a href="randomized-control-trials.html"><i class="fa fa-check"></i><b>1</b> Randomized Control Trials</a>
<ul>
<li class="chapter" data-level="1.1" data-path="subsidies-and-the-african-green-revolution-direct-effects-and-social-network-spillovers-of-randomized-input-subsidies-in-mozambique.html"><a href="subsidies-and-the-african-green-revolution-direct-effects-and-social-network-spillovers-of-randomized-input-subsidies-in-mozambique.html"><i class="fa fa-check"></i><b>1.1</b> Subsidies and the African Green Revolution: Direct effects and social network spillovers of randomized input subsidies in Mozambique</a>
<ul>
<li class="chapter" data-level="" data-path="subsidies-and-the-african-green-revolution-direct-effects-and-social-network-spillovers-of-randomized-input-subsidies-in-mozambique.html"><a href="subsidies-and-the-african-green-revolution-direct-effects-and-social-network-spillovers-of-randomized-input-subsidies-in-mozambique.html#highlights"><i class="fa fa-check"></i>Highlights</a></li>
<li class="chapter" data-level="1.1.1" data-path="subsidies-and-the-african-green-revolution-direct-effects-and-social-network-spillovers-of-randomized-input-subsidies-in-mozambique.html"><a href="subsidies-and-the-african-green-revolution-direct-effects-and-social-network-spillovers-of-randomized-input-subsidies-in-mozambique.html#background-elements"><i class="fa fa-check"></i><b>1.1.1</b> Background elements</a></li>
<li class="chapter" data-level="1.1.2" data-path="subsidies-and-the-african-green-revolution-direct-effects-and-social-network-spillovers-of-randomized-input-subsidies-in-mozambique.html"><a href="subsidies-and-the-african-green-revolution-direct-effects-and-social-network-spillovers-of-randomized-input-subsidies-in-mozambique.html#replication-of-table-2---regressions-with-spillover-effects"><i class="fa fa-check"></i><b>1.1.2</b> Replication of Table 2 - Regressions with spillover effects</a></li>
<li class="chapter" data-level="1.1.3" data-path="subsidies-and-the-african-green-revolution-direct-effects-and-social-network-spillovers-of-randomized-input-subsidies-in-mozambique.html"><a href="subsidies-and-the-african-green-revolution-direct-effects-and-social-network-spillovers-of-randomized-input-subsidies-in-mozambique.html#replication-of-figure-2---direct-and-spillover-impacts-of-subsidies"><i class="fa fa-check"></i><b>1.1.3</b> Replication of Figure 2 - Direct and Spillover Impacts of Subsidies</a></li>
<li class="chapter" data-level="1.1.4" data-path="subsidies-and-the-african-green-revolution-direct-effects-and-social-network-spillovers-of-randomized-input-subsidies-in-mozambique.html"><a href="subsidies-and-the-african-green-revolution-direct-effects-and-social-network-spillovers-of-randomized-input-subsidies-in-mozambique.html#replication-of-table-7---separated-estimation-of-spillover-effects-for-the-first-and-second-years-after-the-program"><i class="fa fa-check"></i><b>1.1.4</b> Replication of Table 7 - Separated Estimation of Spillover Effects for the First and Second Years After the Program</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="instrumental-variables.html"><a href="instrumental-variables.html"><i class="fa fa-check"></i><b>2</b> Instrumental Variables</a>
<ul>
<li class="chapter" data-level="2.1" data-path="winners-and-losers-from-agrarian-reform-evidence-from-danish-land-inequality-16821895.html"><a href="winners-and-losers-from-agrarian-reform-evidence-from-danish-land-inequality-16821895.html"><i class="fa fa-check"></i><b>2.1</b> Winners and losers from Agrarian Reform: Evidence from Danish land inequality 1682–1895</a>
<ul>
<li class="chapter" data-level="" data-path="winners-and-losers-from-agrarian-reform-evidence-from-danish-land-inequality-16821895.html"><a href="winners-and-losers-from-agrarian-reform-evidence-from-danish-land-inequality-16821895.html#highlights-1"><i class="fa fa-check"></i>Highlights</a></li>
<li class="chapter" data-level="2.1.1" data-path="winners-and-losers-from-agrarian-reform-evidence-from-danish-land-inequality-16821895.html"><a href="winners-and-losers-from-agrarian-reform-evidence-from-danish-land-inequality-16821895.html#introduction"><i class="fa fa-check"></i><b>2.1.1</b> Introduction</a></li>
<li class="chapter" data-level="2.1.2" data-path="winners-and-losers-from-agrarian-reform-evidence-from-danish-land-inequality-16821895.html"><a href="winners-and-losers-from-agrarian-reform-evidence-from-danish-land-inequality-16821895.html#identification-strategy"><i class="fa fa-check"></i><b>2.1.2</b> Identification strategy</a></li>
<li class="chapter" data-level="2.1.3" data-path="winners-and-losers-from-agrarian-reform-evidence-from-danish-land-inequality-16821895.html"><a href="winners-and-losers-from-agrarian-reform-evidence-from-danish-land-inequality-16821895.html#from-the-article-to-practice-exploring-the-replication-code"><i class="fa fa-check"></i><b>2.1.3</b> From the article to practice: exploring the replication code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="regression-discontinuity-design.html"><a href="regression-discontinuity-design.html"><i class="fa fa-check"></i><b>3</b> Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="3.1" data-path="the-persistent-effects-of-perus-mining-mita.html"><a href="the-persistent-effects-of-perus-mining-mita.html"><i class="fa fa-check"></i><b>3.1</b> The Persistent Effects of Peru’s Mining <em>Mita</em></a>
<ul>
<li class="chapter" data-level="" data-path="the-persistent-effects-of-perus-mining-mita.html"><a href="the-persistent-effects-of-perus-mining-mita.html#highlights-2"><i class="fa fa-check"></i>Highlights</a></li>
<li class="chapter" data-level="3.1.1" data-path="the-persistent-effects-of-perus-mining-mita.html"><a href="the-persistent-effects-of-perus-mining-mita.html#introduction-1"><i class="fa fa-check"></i><b>3.1.1</b> Introduction</a></li>
<li class="chapter" data-level="3.1.2" data-path="the-persistent-effects-of-perus-mining-mita.html"><a href="the-persistent-effects-of-perus-mining-mita.html#good-practices"><i class="fa fa-check"></i><b>3.1.2</b> Good Practices</a></li>
<li class="chapter" data-level="3.1.3" data-path="the-persistent-effects-of-perus-mining-mita.html"><a href="the-persistent-effects-of-perus-mining-mita.html#table-1---summary-statistics"><i class="fa fa-check"></i><b>3.1.3</b> Table 1 - Summary Statistics</a></li>
<li class="chapter" data-level="3.1.4" data-path="the-persistent-effects-of-perus-mining-mita.html"><a href="the-persistent-effects-of-perus-mining-mita.html#table-2---main-results"><i class="fa fa-check"></i><b>3.1.4</b> Table 2 - Main Results</a></li>
<li class="chapter" data-level="3.1.5" data-path="the-persistent-effects-of-perus-mining-mita.html"><a href="the-persistent-effects-of-perus-mining-mita.html#table-3---robustness-results"><i class="fa fa-check"></i><b>3.1.5</b> Table 3 - Robustness Results</a></li>
<li class="chapter" data-level="3.1.6" data-path="the-persistent-effects-of-perus-mining-mita.html"><a href="the-persistent-effects-of-perus-mining-mita.html#appendix-automatization-of-table-outputs"><i class="fa fa-check"></i><b>3.1.6</b> Appendix: Automatization of table outputs</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="political-fragmentation-and-government-stability-evidence-from-local-governments-in-spain.html"><a href="political-fragmentation-and-government-stability-evidence-from-local-governments-in-spain.html"><i class="fa fa-check"></i><b>3.2</b> Political Fragmentation and Government Stability: Evidence from Local Governments in Spain</a>
<ul>
<li class="chapter" data-level="" data-path="political-fragmentation-and-government-stability-evidence-from-local-governments-in-spain.html"><a href="political-fragmentation-and-government-stability-evidence-from-local-governments-in-spain.html#highlights-3"><i class="fa fa-check"></i>Highlights</a></li>
<li class="chapter" data-level="3.2.1" data-path="political-fragmentation-and-government-stability-evidence-from-local-governments-in-spain.html"><a href="political-fragmentation-and-government-stability-evidence-from-local-governments-in-spain.html#introduction-2"><i class="fa fa-check"></i><b>3.2.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2.2" data-path="political-fragmentation-and-government-stability-evidence-from-local-governments-in-spain.html"><a href="political-fragmentation-and-government-stability-evidence-from-local-governments-in-spain.html#rdd-methodology-and-paper-summary"><i class="fa fa-check"></i><b>3.2.2</b> RDD Methodology and Paper Summary</a></li>
<li class="chapter" data-level="3.2.3" data-path="political-fragmentation-and-government-stability-evidence-from-local-governments-in-spain.html"><a href="political-fragmentation-and-government-stability-evidence-from-local-governments-in-spain.html#good-practices-before-starting"><i class="fa fa-check"></i><b>3.2.3</b> Good Practices Before Starting</a></li>
<li class="chapter" data-level="3.2.4" data-path="political-fragmentation-and-government-stability-evidence-from-local-governments-in-spain.html"><a href="political-fragmentation-and-government-stability-evidence-from-local-governments-in-spain.html#descriptive-statistics"><i class="fa fa-check"></i><b>3.2.4</b> Descriptive Statistics</a></li>
<li class="chapter" data-level="3.2.5" data-path="political-fragmentation-and-government-stability-evidence-from-local-governments-in-spain.html"><a href="political-fragmentation-and-government-stability-evidence-from-local-governments-in-spain.html#empirical-strategy"><i class="fa fa-check"></i><b>3.2.5</b> Empirical Strategy</a></li>
<li class="chapter" data-level="3.2.6" data-path="political-fragmentation-and-government-stability-evidence-from-local-governments-in-spain.html"><a href="political-fragmentation-and-government-stability-evidence-from-local-governments-in-spain.html#main-results"><i class="fa fa-check"></i><b>3.2.6</b> Main Results</a></li>
<li class="chapter" data-level="3.2.7" data-path="political-fragmentation-and-government-stability-evidence-from-local-governments-in-spain.html"><a href="political-fragmentation-and-government-stability-evidence-from-local-governments-in-spain.html#robustness-checks"><i class="fa fa-check"></i><b>3.2.7</b> Robustness Checks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="differences-in-discontinuity-design.html"><a href="differences-in-discontinuity-design.html"><i class="fa fa-check"></i><b>4</b> Differences in Discontinuity Design</a>
<ul>
<li class="chapter" data-level="4.1" data-path="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html"><i class="fa fa-check"></i><b>4.1</b> Equality of opportunity and human capital accumulation: Motivational effect of a nationwide scholarship in Colombia</a>
<ul>
<li class="chapter" data-level="" data-path="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#highlights-4"><i class="fa fa-check"></i>Highlights</a></li>
<li class="chapter" data-level="4.1.1" data-path="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#before-we-start"><i class="fa fa-check"></i><b>4.1.1</b> Before we start</a></li>
<li class="chapter" data-level="4.1.2" data-path="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#introduction-3"><i class="fa fa-check"></i><b>4.1.2</b> Introduction</a></li>
<li class="chapter" data-level="4.1.3" data-path="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#main-strategies-explanation-regression-discontinuity-design-and-quantile-regressions"><i class="fa fa-check"></i><b>4.1.3</b> Main strategies explanation: Regression Discontinuity Design and Quantile Regressions</a></li>
<li class="chapter" data-level="4.1.4" data-path="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#descriptive-statistics---replication-of-table-1-and-figure-4"><i class="fa fa-check"></i><b>4.1.4</b> Descriptive statistics - Replication of Table 1 and Figure 4</a></li>
<li class="chapter" data-level="4.1.5" data-path="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#main-results---replication-of-table-3"><i class="fa fa-check"></i><b>4.1.5</b> Main results - Replication of Table 3</a></li>
<li class="chapter" data-level="4.1.6" data-path="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#robustness-check---replication-of-figure-a2"><i class="fa fa-check"></i><b>4.1.6</b> Robustness check - Replication of Figure A2</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Equality of opportunity and human capital accumulation: Motivational effect of a nationwide scholarship in Colombia<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Rachid Laajaj, Andrés Moya, Fabio Sánchez, Equality of opportunity and human capital accumulation: Motivational effect of a nationwide scholarship in Colombia, <em>Journal of Development Economics</em>, Volume 154, 2022, 102754, ISSN 0304-3878,
.<a href="https://doi.org/10.1016/j.jdeveco.2021.102754" target="_blank">https://doi.org/10.1016/j.jdeveco.2021.102754</a></p>
<a href="https://git-link.vercel.app/api/download?url=https%3A%2F%2Fgithub.com%2FSorbonneDevEcon%2FM2-Econometrics-Book%2Fblob%2Fmain%2Fresources%2FLMS%2FDo-File_LMS.do&amp;filename=Do-File_LMS.do">
<button class="btn btn-default"><i class="fa fa-save"></i> Download Do-File corresponding to the explanations below</button>
</a>
<a href="https://git-link.vercel.app/api/download?url=https%3A%2F%2Fgithub.com%2FSorbonneDevEcon%2FM2-Econometrics-Book%2Fblob%2Fmain%2Fresources%2FLMS%2FCodebook_LMS.pdf&amp;filename=Codebook_LMS.pdf">
<button class="btn btn-default"><i class="fa fa-save"></i> Download Codebook</button>
</a>
<a href="https://www.openicpsr.org/openicpsr/project/146921/version/V1/view">
<button class="btn btn-default"><i class="fa fa-save"></i> Download Original Data (Data>Originals>SPP_ready.dta)</button>
</a>
<p><a href="https://www.openicpsr.org/openicpsr/project/146921/version/V1/view" target="_blank">[Link to the full original replication package paper from Open ICPSR]</a></p>
<div id="highlights-4" class="section level3 unnumbered hasAnchor">
<h3>Highlights<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#highlights-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>The research question of this paper is the following: How did the opportunity to receive a scholarship influence the performance of low-income students in the national exit and 9th grade exams, and their university enrollment rates?</p></li>
<li><p>This replication exercise will deal with the quasi-experimental Regression Discontinuity Design (RDD) method, with an <strong>eligibility cutoff</strong> and a <strong>linear function</strong> (and its extension in the form of difference-in-discontinuities model).</p></li>
<li><p>This methodology is applied in this context because the scholarship eligibility is based on an eligibility threshold, which allows the authors to compare similar students and thus, avoid the issue of selection on unobservable.</p></li>
<li><p>The special feature of this study is the combination of the regression discontinuity design extension, with the <strong>quantile regression method</strong>.</p></li>
<li><p>Throughout this replication exercise, we provide a detailed explanation of the original replication package.</p></li>
<li><p>Through this exercise, you will learn many tricks on Stata:</p>
<ul>
<li>How to present your results in academic tables, by using the packages <code>estout</code> and <code>outreg2</code></li>
<li>How to use bandwidths in a regression, here the optimal bandwidth from <a href="https://doi.org/10.3982/ECTA11757" target="_blank">Calonico et al. (2014)</a> using the <code>rdrobust</code> package</li>
<li>How to run multiple loops within another loop</li>
<li>How to use the <code>grc1leg</code> package to merge different graphs in only one figure, using an online package</li>
<li>How to conduct regression discontinuity analysis using the package <code>rddensity</code>, and more specifically to test for manipulation (Cattaneo et al., 2018)</li>
</ul></li>
</ul>
</div>
<div id="before-we-start" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Before we start<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#before-we-start" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you wish to replicate yourself, you will need to download the original dataset <code>SPP_ready.dta</code> from the <a href="https://www.openicpsr.org/openicpsr/project/146921/version/V1/view" target="_blank">original replication package</a>.</p>
<p>Then, follow these instructions:</p>
<div class="sourceCode" id="cb77" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb77-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-1" tabindex="-1"></a></span>
<span id="cb77-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-2" tabindex="-1"></a>Set the directory where you have stored the dataset SPP_ready.dta and where you will <span class="kw">store</span> your datasets and results:</span>
<span id="cb77-3"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-3" tabindex="-1"></a>cd <span class="st">&quot;put here your own working directory&quot;</span></span>
<span id="cb77-4"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-4" tabindex="-1"></a></span>
<span id="cb77-5"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-5" tabindex="-1"></a>*Data Preparation    </span>
<span id="cb77-6"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-6" tabindex="-1"></a><span class="kw">use</span> <span class="st">&quot;SPP_ready.dta&quot;</span>, <span class="kw">clear</span></span>
<span id="cb77-7"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-7" tabindex="-1"></a></span>
<span id="cb77-8"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-8" tabindex="-1"></a>*<span class="kw">keep</span> only the variables we need <span class="kw">for</span> the replication</span>
<span id="cb77-9"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-9" tabindex="-1"></a><span class="kw">keep</span> ranking eligible_post eligible non_eligible <span class="kw">post</span> sisben sisben_eligible sisben_post sisben_eligible_post area_ciudades area_urbano icfes_padre_nivel1 icfes_padre_nivel2 icfes_padre_nivel3 icfes_madre_nivel1 icfes_madre_nivel2 icfes_madre_nivel3 edad sexo_sisben departamento_cod_* saber_rk_col area_sisben_dnp puntaje_sisben_dnp <span class="fu">year</span> </span>
<span id="cb77-10"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-10" tabindex="-1"></a></span>
<span id="cb77-11"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-11" tabindex="-1"></a>*<span class="kw">rename</span> the variables </span>
<span id="cb77-12"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-12" tabindex="-1"></a><span class="kw">rename</span> area_ciudades cities </span>
<span id="cb77-13"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-13" tabindex="-1"></a><span class="kw">rename</span> area_urbano other_urban </span>
<span id="cb77-14"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-14" tabindex="-1"></a><span class="kw">rename</span> icfes_padre_nivel1 father_educ_prim </span>
<span id="cb77-15"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-15" tabindex="-1"></a><span class="kw">rename</span> icfes_padre_nivel2 father_educ_second </span>
<span id="cb77-16"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-16" tabindex="-1"></a><span class="kw">rename</span> icfes_padre_nivel3 father_educ_high </span>
<span id="cb77-17"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-17" tabindex="-1"></a><span class="kw">rename</span> icfes_madre_nivel1 mother_educ_prim </span>
<span id="cb77-18"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-18" tabindex="-1"></a><span class="kw">rename</span> icfes_madre_nivel2 mother_educ_second </span>
<span id="cb77-19"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-19" tabindex="-1"></a><span class="kw">rename</span> icfes_madre_nivel3 mother_educ_high </span>
<span id="cb77-20"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-20" tabindex="-1"></a><span class="kw">rename</span> edad age</span>
<span id="cb77-21"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-21" tabindex="-1"></a><span class="kw">rename</span> sexo_sisben sex </span>
<span id="cb77-22"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-22" tabindex="-1"></a><span class="kw">rename</span> area_sisben_dnp area_sisben</span>
<span id="cb77-23"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-23" tabindex="-1"></a><span class="kw">rename</span> puntaje_sisben_dnp score_sisben </span>
<span id="cb77-24"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-24" tabindex="-1"></a><span class="kw">rename</span> saber_rk_col saber_avg_school</span>
<span id="cb77-25"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-25" tabindex="-1"></a></span>
<span id="cb77-26"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-26" tabindex="-1"></a>*change labels <span class="kw">for</span> the <span class="kw">variable</span> area_sisben</span>
<span id="cb77-27"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-27" tabindex="-1"></a><span class="kw">label</span> <span class="kw">define</span> new_labels 1 <span class="st">&quot;14 Main Cities&quot;</span> 2 <span class="st">&quot;Urban Rest&quot;</span> 3 <span class="st">&quot;Rural&quot;</span></span>
<span id="cb77-28"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-28" tabindex="-1"></a><span class="kw">label</span> <span class="kw">values</span> area_sisben new_labels</span>
<span id="cb77-29"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-29" tabindex="-1"></a></span>
<span id="cb77-30"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-30" tabindex="-1"></a>*<span class="kw">use</span> a loop to <span class="kw">rename</span> several variables</span>
<span id="cb77-31"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-31" tabindex="-1"></a>forval i = 1/33 {</span>
<span id="cb77-32"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-32" tabindex="-1"></a>    <span class="kw">local</span> oldvar <span class="st">&quot;departamento_cod_`i&#39;&quot;</span></span>
<span id="cb77-33"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-33" tabindex="-1"></a>    <span class="kw">local</span> newvar <span class="st">&quot;department_`i&#39;&quot;</span></span>
<span id="cb77-34"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-34" tabindex="-1"></a>    <span class="kw">rename</span> <span class="ot">`oldvar&#39;</span> <span class="ot">`newvar&#39;</span></span>
<span id="cb77-35"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-35" tabindex="-1"></a>}</span>
<span id="cb77-36"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-36" tabindex="-1"></a></span>
<span id="cb77-37"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-37" tabindex="-1"></a><span class="kw">gen</span> status_eligible= 1 <span class="kw">if</span> non_eligible == 0 &amp; <span class="kw">post</span> ==0</span>
<span id="cb77-38"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-38" tabindex="-1"></a><span class="kw">replace</span>  status_eligible= 2 <span class="kw">if</span> non_eligible == 1 &amp; <span class="kw">post</span> ==0</span>
<span id="cb77-39"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-39" tabindex="-1"></a><span class="kw">replace</span>  status_eligible = 3 <span class="kw">if</span> non_eligible == 0 &amp; <span class="kw">post</span> ==1</span>
<span id="cb77-40"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-40" tabindex="-1"></a><span class="kw">replace</span>  status_eligible = 4 <span class="kw">if</span> non_eligible ==1 &amp; <span class="kw">post</span> ==1</span>
<span id="cb77-41"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-41" tabindex="-1"></a></span>
<span id="cb77-42"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-42" tabindex="-1"></a><span class="kw">label</span> <span class="kw">define</span> status_eligible_labels 1 <span class="st">&quot;Need-based Eligible 2013-2014&quot;</span> 2 <span class="st">&quot;Non-Eligible 2013-2014&quot;</span> 3 <span class="st">&quot;Need-based Eligible 2015&quot;</span> 4 <span class="st">&quot;Non-Eligible 2015&quot;</span></span>
<span id="cb77-43"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-43" tabindex="-1"></a></span>
<span id="cb77-44"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-44" tabindex="-1"></a>* Apply the labels to the categorical <span class="kw">variable</span></span>
<span id="cb77-45"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-45" tabindex="-1"></a><span class="kw">label</span> <span class="kw">values</span> status_eligible non_eligible_post_labels</span>
<span id="cb77-46"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-46" tabindex="-1"></a><span class="kw">drop</span> non_eligible </span>
<span id="cb77-47"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-47" tabindex="-1"></a></span>
<span id="cb77-48"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-48" tabindex="-1"></a><span class="kw">label</span> <span class="kw">variable</span> score_sisben <span class="st">&quot;Score Sisbén DNP&quot;</span></span>
<span id="cb77-49"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-49" tabindex="-1"></a><span class="kw">label</span> <span class="kw">variable</span> area_sisben <span class="st">&quot;Area Sisbén DNP&quot;</span></span>
<span id="cb77-50"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-50" tabindex="-1"></a><span class="kw">label</span> <span class="kw">variable</span> father_educ_prim <span class="st">&quot;Father&#39;s primary education&quot;</span></span>
<span id="cb77-51"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-51" tabindex="-1"></a><span class="kw">label</span> <span class="kw">variable</span> father_educ_second <span class="st">&quot;Father&#39;s secondary education&quot;</span></span>
<span id="cb77-52"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-52" tabindex="-1"></a><span class="kw">label</span> <span class="kw">variable</span> father_educ_high <span class="st">&quot;Father&#39;s high school education&quot;</span></span>
<span id="cb77-53"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-53" tabindex="-1"></a><span class="kw">label</span> <span class="kw">variable</span> mother_educ_prim <span class="st">&quot;Mother&#39;s primary education&quot;</span></span>
<span id="cb77-54"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-54" tabindex="-1"></a><span class="kw">label</span> <span class="kw">variable</span> mother_educ_second <span class="st">&quot;Mother&#39;s secondary education&quot;</span></span>
<span id="cb77-55"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-55" tabindex="-1"></a><span class="kw">label</span> <span class="kw">variable</span> mother_educ_high <span class="st">&quot;Mother&#39;s high school education&quot;</span></span>
<span id="cb77-56"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-56" tabindex="-1"></a><span class="kw">label</span> <span class="kw">variable</span> sex <span class="st">&quot;Sex&quot;</span></span>
<span id="cb77-57"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-57" tabindex="-1"></a><span class="kw">label</span> <span class="kw">variable</span> cities <span class="st">&quot;14 Main Cities&quot;</span></span>
<span id="cb77-58"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-58" tabindex="-1"></a><span class="kw">label</span> <span class="kw">variable</span> other_urban <span class="st">&quot;Other cities&quot;</span></span>
<span id="cb77-59"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-59" tabindex="-1"></a><span class="kw">label</span> <span class="kw">variable</span> ranking <span class="st">&quot;Ranking Saber test&quot;</span></span>
<span id="cb77-60"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-60" tabindex="-1"></a><span class="kw">label</span> <span class="kw">variable</span> sisben <span class="st">&quot;Distance to the threshold&quot;</span></span>
<span id="cb77-61"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-61" tabindex="-1"></a><span class="kw">label</span> <span class="kw">variable</span> <span class="kw">post</span> <span class="st">&quot;Before or after SPP&quot;</span></span>
<span id="cb77-62"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-62" tabindex="-1"></a><span class="kw">label</span> <span class="kw">variable</span> eligible <span class="st">&quot;Eligibility&quot;</span></span>
<span id="cb77-63"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-63" tabindex="-1"></a><span class="kw">label</span> <span class="kw">variable</span> eligible_post <span class="st">&quot;Treated or not&quot;</span></span>
<span id="cb77-64"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-64" tabindex="-1"></a><span class="kw">label</span> <span class="kw">variable</span> status_eligible <span class="st">&quot;Student&#39;s status&quot;</span></span>
<span id="cb77-65"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-65" tabindex="-1"></a><span class="kw">label</span> <span class="kw">variable</span> saber_avg_school <span class="st">&quot;Saber average score of middle school&quot;</span></span>
<span id="cb77-66"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-66" tabindex="-1"></a></span>
<span id="cb77-67"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb77-67" tabindex="-1"></a><span class="kw">save</span> <span class="st">&quot;dataset_LMS.dta&quot;</span>, <span class="kw">replace</span> <span class="co">// save the dataset created in a new file</span></span></code></pre></div>
<p>You will also have to install a few packages and set up a global listing the control variables used in the regressions.</p>
<div class="sourceCode" id="cb78" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb78-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb78-1" tabindex="-1"></a></span>
<span id="cb78-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb78-2" tabindex="-1"></a>** Necessary packages to <span class="kw">run</span> the code:</span>
<span id="cb78-3"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb78-3" tabindex="-1"></a><span class="kw">ssc</span> install estout, <span class="kw">replace</span></span>
<span id="cb78-4"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb78-4" tabindex="-1"></a><span class="kw">ssc</span> install outreg2, <span class="kw">replace</span></span>
<span id="cb78-5"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb78-5" tabindex="-1"></a><span class="kw">ssc</span> install rdrobust, <span class="kw">replace</span></span>
<span id="cb78-6"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb78-6" tabindex="-1"></a>net install grc1leg.pkg, <span class="kw">replace</span></span>
<span id="cb78-7"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb78-7" tabindex="-1"></a><span class="kw">ssc</span> install rddensity, <span class="kw">replace</span></span>
<span id="cb78-8"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb78-8" tabindex="-1"></a></span>
<span id="cb78-9"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb78-9" tabindex="-1"></a>**Set a <span class="kw">global</span> <span class="kw">for</span> <span class="ot">all</span> the control variables used <span class="kw">in</span> regressions</span>
<span id="cb78-10"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb78-10" tabindex="-1"></a><span class="kw">global</span> controls cities other_urban father_educ_prim father_educ_second father_educ_high mother_educ_prim mother_educ_second mother_educ_high age sex department_1-department_32 saber_avg_school</span></code></pre></div>
<p>Now you can open the dataset:</p>
<div class="sourceCode" id="cb79" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb79-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb79-1" tabindex="-1"></a><span class="kw">use</span> <span class="st">&quot;dataset_LMS.dta&quot;</span>, <span class="kw">clear</span></span></code></pre></div>
</div>
<div id="introduction-3" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Introduction<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#introduction-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In 2014, a <strong>scholarship</strong> named Ser Pilo Paga (SPP), meaning “Being a Good Student Pays Off”, was introduced in Colombia in order to allow meriting students coming from low- income households to go to high-quality universities by <strong>funding their entire undergraduate education and living expenses</strong>.</p>
<p>The eligibility for this scholarship is based on two criteria. First, students must come from a household that scored below a certain cutoff on the <em>Sisbén index</em>, which is a <strong>socioeconomic index</strong>. Second, students must have scored above a given cutoff on the <em>Saber 11</em>, which is the <strong>national high school exit exam</strong>.</p>
<p>Data on the <em>Sisbén</em> scores are available at the <em>Department Nacional de Planeacion</em>, and the information on the <em>Saber 11</em> test scores is provided by the <em>Instituto Colombiano para el Fomento de la Educación Superior</em>.</p>
<p>This paper analyzes the motivational effect of this scholarship on three dimensions: the students’ <strong>performances at the <em>Saber 11</em></strong>, the <strong>enrollment rates in high-quality universities</strong> and the <strong>students’ performances at the <em>Saber 9</em></strong> to test for the ex-ante motivational effect.</p>
<p>This replication paper exercise will be focused on the effect of the SPP on the students’ test scores at the <em>Saber 11</em>. The authors used a <strong>difference-in-discontinuities model</strong>, an extension of the Regression Discontinuity Design (RDD) approach. The latter consists in estimating a local average treatment effect around a given cutoff to compare individuals with similar characteristics and be able to attribute the difference in outcomes to the only effect of the treatment. The difference-in-discontinuities extension allows studying the differences around a discontinuity threshold as in a standard RDD, and at two different time periods. Here, the authors study the discontinuity around the need-based eligibility cutoff, comparing students just below and above the threshold, two and ten months after the introduction of SPP.</p>
<p>Together with <strong>quantile regression</strong>, the authors are able to show a positive and significant effect of the SPP concentrated at the <strong>top of the distribution</strong> (from the 70th percentile), emphasizing the SPP’s contribution to a reduction in socioeconomic achievement gap between eligible and non-eligible students.</p>
<p>Throughout a replication exercise of the article by Laajaj, Moya and Sánchez, the following aims at providing an explanation of the main insights of the Regression Discontinuity Design and Quantile Regression frameworks, as well as some methodological and code explanation to improve your Stata skills.</p>
</div>
<div id="main-strategies-explanation-regression-discontinuity-design-and-quantile-regressions" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Main strategies explanation: Regression Discontinuity Design and Quantile Regressions<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#main-strategies-explanation-regression-discontinuity-design-and-quantile-regressions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="regression-discontinuity-design-1" class="section level4 hasAnchor" number="4.1.3.1">
<h4><span class="header-section-number">4.1.3.1</span> Regression Discontinuity Design<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#regression-discontinuity-design-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Regression Discontinuity Design is a method that leverages a <strong>natural experiment</strong>, utilizing a threshold or <strong>cutoff point</strong> to determine who receives treatment. The core idea is to compare the outcomes of individuals who receive treatment to those who do not by examining both sides of this threshold. The <strong>running variable</strong> X assigns observations to treatment given the cutoff value C.
Here, the RDD takes the form of a <strong>standard eligibility cutoff with a linear function</strong>. Though, in other RDD settings, you might encounter spatial RDD with a border as threshold (Black, 1999) or Regression Kink Design, with a discontinuity showing a kink in the treatment variable (Card et al., 2015).</p>
<p>The key identifying assumption here is that individuals situated just above or below the threshold share similarity in all aspects except for the treatment they are subjected to. This assumption enables researchers to attribute disparities in results solely to the treatment, sidestepping the issue of selection bias.</p>
<p>To extrapolate the discontinuity, one needs to set up a window called <strong>bandwidths</strong>, containing the treated and control units.</p>
<p>There are two main designs within RDD: the <strong>sharp</strong> design and the <strong>fuzzy</strong> design.</p>
<ul>
<li><p>In the sharp design, the treatment assignment is a deterministic function of the running variable X. Units are either treated or not, depending on whether they fall on one side or the other of the threshold.</p></li>
<li><p>In the fuzzy design, the treatment assignment is not strictly determined by the threshold, there can be instances of imperfect compliance. The probability of receiving treatment might jump at the threshold. Some units may not receive treatment even if they were expected to, and vice versa.</p></li>
</ul>
<p>To identify the treatment effect at the discontinuity, one needs to specify the potential outcomes model as a <strong>flexible function of the running variable</strong>. The specification of the functions is empirically important, as it needs to be flexible enough to get the functional form of the relationship between the outcome variable and the running variable.</p>
<p>In our paper, the authors are using a <strong>standard eligibility cutoff</strong>, in a <strong>sharp design</strong>, estimating the change in ranking of the national high school exit exam (<em>Saber 11</em>) after the introduction of a merit- and need-based scholarship in Columbia (SPP). The treatment is a specific cutoff on the <em>Sisbén</em> (the socioeconomic index used by the government to target subsidies and social programs): students coming from low-income households under the cutoff are eligible and those above are not eligible. The authors are using a <strong>linear function for the functional form of the relationship between <em>Sisbén</em> and the ranking</strong>. The <strong><em>Sisbén</em> cutoff</strong> is based on the households’ geographic location:</p>
<ul>
<li>57,21 for the 14 main cities</li>
<li>56,32 for other urban areas</li>
<li>40,75 for rural areas</li>
</ul>
<p>The <strong>running variable</strong> here is the distance between the student’s <em>Sisbén</em> score and the need-based eligibility cutoff. Students taken into account in the study are assumed to be similar, the only difference being the threshold and thus the possibility of receiving the scholarship or not ex-post.</p>
<p>To isolate the confounding effect of other social programs established prior to SPP sharing the same eligibility cutoffs, the authors use the <strong>difference-in-discontinuities extension of the RDD</strong>. This method allows the authors to study, around the need-based eligibility cutoff, the motivational effect of SPP by comparing two time periods. The model was introduced by &lt;a href=”
<a href="https://doi.org/10.1257/app.20150076" class="uri">https://doi.org/10.1257/app.20150076</a> target=“_blank”&gt;Grembi et al. (2016)</a>.</p>
<p>The <strong>difference-in-discontinuities</strong> estimate compares <strong>two cohorts</strong>: the <strong>2015 cohort</strong>, composed of students who passed the Saber 11 exam in 2015, 10 months after the implementation of SPP, and the <strong>2014 cohort</strong> that comprises students who passed the Saber 11 exam only two months after the implementation of SPP. The 2014 cohort is taken as a control group: since SPP was launched for the first time not long before their <em>Saber 11</em> exam, their motivation and results cannot be influenced by the program itself. However, the program can be considered as a credible signal for 2015 students, hence the comparison in the motivational effect of SPP between eligible and non-eligible students (on both sides of the threshold), two months after SPP implementation (2014 students, post=0) and ten months after (2015 cohort, post=1).</p>
</div>
<div id="quantile-regression" class="section level4 hasAnchor" number="4.1.3.2">
<h4><span class="header-section-number">4.1.3.2</span> Quantile Regression<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#quantile-regression" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In addition to their RDD specification, the authors are testing for heterogeneous effects of the scholarship program on students with different test scores in <em>Saber 11</em> using quantile regressions. While an OLS model is minimizing the sum of squared residuals, the quantile regression model minimizes the objective loss function (sum of absolute weighted deviations). Contrary to OLS, there is no explicit solution for this minimization. Thus, it should be done numerically via the simplex method (a method using iterations). This explains why, each time you run a quantile regression code, the Stata software will display several successive iterations in the “Results” window before displaying the final regression result (see image below).</p>
<p><img src="resources/LMS/image1.png" /></p>
<p>They regress the test scores (variable “ranking”) on the scholarship eligibility for students who passed the <em>Saber 11</em> exam after the introduction of SPP (variables “eligible” and “eligible_post”) and the running variable (variable “sisben”) at the 25th , 50th, 75th and 90th percentiles. This method has the advantage of studying the effect of a treatment on the entire distribution of interest, not only on its conditional mean. In this paper, this method is crucial because the authors find no motivational average effect of the SPP on the <em>Saber 11</em> test scores, while they find a positive effect starting from the 75th percentile. These results can be explained by the level of the merit-based cutoff. Indeed, as this ranking cutoff is away from the median, students at the bottom of the distribution will feel discouraged and give up as it would require too much effort to try reaching it.</p>
</div>
</div>
<div id="descriptive-statistics---replication-of-table-1-and-figure-4" class="section level3 hasAnchor" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Descriptive statistics - Replication of Table 1 and Figure 4<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#descriptive-statistics---replication-of-table-1-and-figure-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="main-insights-of-descriptive-statistics" class="section level4 hasAnchor" number="4.1.4.1">
<h4><span class="header-section-number">4.1.4.1</span> Main insights of descriptive statistics<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#main-insights-of-descriptive-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>It is essential to run some descriptive statistics at every stage of a research project. Descriptive statistics play a crucial role in an econometric regression framework by providing a comprehensive summary of the data under consideration. By depicting the key insights and trends of the variables of interest, they serve to demonstrate the motivation behind the analysis, and provide justification for the chosen empirical strategy. Good descriptive statistics should also highlight the main results, ensuring the alignment of the research in the intended direction. Descriptive statistics also serve as an initial step in exploring the dataset, verifying the coherence of values and identifying any potential missing data issues.</p>
<p>The command <code>summarize</code> in Stata shows you directly the mean, standard deviation, minimum, and maximum of the desired variables. However, descriptive statistics can also take the form of a graph depicting the correlation between two variables of interest, a figure, a map or even non-causal regressions. Nevertheless, whatever the form it adopts, the primary focus should remain on data visualization: descriptive statistics must be clear, and allow us to catch the main information very quickly.</p>
</div>
<div id="replication-of-table-1---average-rank-of-eligible-and-non-eligible-students-in-the-saber-11" class="section level4 hasAnchor" number="4.1.4.2">
<h4><span class="header-section-number">4.1.4.2</span> Replication of Table 1 - Average rank of eligible and non-eligible students in the <em>Saber 11</em><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#replication-of-table-1---average-rank-of-eligible-and-non-eligible-students-in-the-saber-11" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="replication-of-the-means-for-average-and-quantiles-scores-using-tabstat-and-the-package-estout" class="section level5 unnumbered hasAnchor">
<h5>Replication of the means for average and quantiles scores using tabstat and the package <code>estout</code><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#replication-of-the-means-for-average-and-quantiles-scores-using-tabstat-and-the-package-estout" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The paper presents different sets of descriptive statistics. The focus is on replicating Table 1, which displays the average rank of eligible and non-eligible students in the <em>Saber 11</em> test two months after the implementation of SPP (2013-2014 cohort) and ten months after (2015 cohort). It also details the rank of students at the 25th, 50th, 75th, and 90th percentiles within each group.</p>
<p>The replication of Table 1 will take place in two steps: first, the replication of rows (1), (2), (4) and (5) of parts A and B of the table and then row (7) from part C.</p>
<p>At the end of this part 1 of the replication exercise, you should have the following .txt output of Table 1, parts (A) and (B).
<img src="resources/LMS/image2.png" />
The first part of Table 1 (rows (1), (2), (4) and (5) of parts A and B) displays the means for averages scores and for each quantile (25, 50, 75, 90). To replicate it, you will use the <code>tabstat</code> command with the “status_eligible” variable.</p>
<p>With the <code>tabstat</code> command, you can select the desired statistics of the “ranking” variable with statistics, in this case the number of observations (N), the mean, the quantiles p25, p50, p75 and p90 (q and p90).</p>
<p>To do so, you will first need to save it with the <code>estpost</code> command, with the name of your choice (here: A).</p>
<p>The <code>estpost</code>, <code>eststo</code> and <code>esttab</code> commands are available in the <code>estout</code> package.</p>
<div class="sourceCode" id="cb80" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb80-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb80-1" tabindex="-1"></a><span class="kw">ssc</span> install estout</span>
<span id="cb80-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb80-2" tabindex="-1"></a>eststo A: estpost <span class="kw">tabstat</span> ranking, <span class="kw">by</span>(status_eligible) <span class="kw">statistics</span>(<span class="kw">N</span> <span class="kw">mean</span> <span class="fu">q</span> p90) <span class="kw">columns</span>(<span class="kw">statistics</span>) </span></code></pre></div>
<p><code>tabstat</code> displays summary statistics (here the number of observations, the mean and the 25th, 50th, 75th and the 90th quantiles).</p>
<p>Then, you can export it in the desired format with <code>esttab</code> (here .txt) with the desired features:</p>
<ul>
<li><p><code>fmt(1)</code> gives the desired number of decimal places,</p></li>
<li><p><code>label</code> gives the name of the labels in the output table,</p></li>
<li><p><code>varwidth(30)</code> gives the width of the column containing the variable names.</p></li>
</ul>
<div class="sourceCode" id="cb81" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb81-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb81-1" tabindex="-1"></a>esttab A <span class="kw">using</span> <span class="st">&quot;means.txt&quot;</span>, cells(<span class="st">&quot;mean(fmt(1)) p25(fmt(1)) p50(fmt(1)) p75(fmt(1)) p90(fmt(1))&quot;</span>) <span class="bn">title</span>(<span class="st">&quot;Table 1. Saber 11 rank of eligible and non-eligible students before and after the motivational effect&quot;</span>) <span class="kw">noobs</span> nonumber nonote nostar <span class="kw">label</span> <span class="kw">replace</span> varwidth(30) </span></code></pre></div>
</div>
<div id="replication-of-the-descriptive-diff-in-diff-in-average-and-by-quantile-using-outreg2" class="section level5 unnumbered hasAnchor">
<h5>Replication of the descriptive diff-in-diff in average and by quantile, using <code>outreg2</code><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#replication-of-the-descriptive-diff-in-diff-in-average-and-by-quantile-using-outreg2" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>To replicate the last part of table 1, row (7) of part C, which is the descriptive diff-in-diff in average then by percentile, you will do it in two steps:</p>
<p><strong>Step 1</strong>: Run a basic diff-in-diff regression of ranking on the variables “eligible_post”, “eligible” and “post” and export it in excel format</p>
<div class="sourceCode" id="cb82" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb82-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb82-1" tabindex="-1"></a><span class="kw">reg</span> ranking eligible_post eligible <span class="kw">post</span>, <span class="kw">vce</span> (<span class="kw">robust</span>)</span></code></pre></div>
<p>Once the regression is estimated, we can use the command outreg2 to report the regression outputs from Stata into Excel, Word, Latex or any other format. It gives you the type of presentation found in academic papers. To use it, you have to install the package outreg2 first.</p>
<div class="sourceCode" id="cb83" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb83-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb83-1" tabindex="-1"></a><span class="kw">ssc</span> install outreg2</span>
<span id="cb83-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb83-2" tabindex="-1"></a>outreg2 <span class="kw">using</span> <span class="st">&quot;descr_DiD_.xls&quot;</span>, <span class="kw">label</span> <span class="co">///</span></span>
<span id="cb83-3"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb83-3" tabindex="-1"></a>ctitle(<span class="st">&quot;Average Rank&quot;</span>) <span class="kw">replace</span> less (1)</span></code></pre></div>
<p>Step 2: Run the same regression but in quantiles, using a loop for each quantile, and then export it in an excel format (.xls) and append it to the basic diff-in-diff table you got in Step 1.</p>
<div class="sourceCode" id="cb84" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb84-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb84-1" tabindex="-1"></a><span class="kw">foreach</span> j <span class="kw">in</span> .25 .50 .75 .90 {</span>
<span id="cb84-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb84-2" tabindex="-1"></a><span class="kw">qreg</span> ranking eligible_post eligible <span class="kw">post</span>, <span class="fu">q</span>(<span class="ot">`j&#39;</span>) <span class="kw">vce</span> (<span class="kw">robust</span>) </span>
<span id="cb84-3"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb84-3" tabindex="-1"></a>outreg2 <span class="kw">using</span> <span class="st">&quot;descr_DiD_.xls&quot;</span>, <span class="co">///</span></span>
<span id="cb84-4"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb84-4" tabindex="-1"></a>ctitle(<span class="ot">`j&#39;</span>) <span class="kw">append</span> less (1)  </span>
<span id="cb84-5"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb84-5" tabindex="-1"></a>}</span></code></pre></div>
<p>At the end of this part 2) of the replication exercise, you should have the following .xls output of Table 1, part (C).
<img src="resources/LMS/image3.png" /></p>
<p><strong>The following results can be drawn from the table</strong>:</p>
<ul>
<li><p>First, non-eligible students have in general a better ranking than eligible, revealing the importance of targeting this subpopulation. (Part A and B of table 1).</p></li>
<li><p>Then, there is a reduction of the gap between eligible and non-eligible students after the implementation of SPP (by calculating the difference between non-eligible’s rank and eligible’s rank). This suggests a potential positive motivational effect of the program on students’ results.</p></li>
<li><p>With a simple difference-in-differences regression, the authors compute the significance of the gap reduction (part C of table 1). The gap reduction is much more important from the 75th percentile of the distribution, suggesting that even with an effect at the average, the impact of SPP is only significant for students ranked at the top of the distribution.</p></li>
</ul>
<p><strong>Two main conclusions can be drawn from this table</strong>:</p>
<ul>
<li><p>It provides support for estimating a causal effect of SPP on motivation, by comparing eligible and non-eligible students.</p></li>
<li><p>It highlights the interest of a quantile regression to study the potential heterogeneous treatment effect at different points of the distribution of ranking.</p></li>
</ul>
</div>
</div>
<div id="replication-of-figure-4---graphical-representation-of-the-regression-in-discontinuities-estimators-on-average-effect-and-at-each-quantile" class="section level4 hasAnchor" number="4.1.4.3">
<h4><span class="header-section-number">4.1.4.3</span> Replication of Figure 4 - Graphical representation of the Regression-in-Discontinuities estimators on average effect, and at each quantile<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#replication-of-figure-4---graphical-representation-of-the-regression-in-discontinuities-estimators-on-average-effect-and-at-each-quantile" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Moreover, RDD is a special case where graphical representations as descriptive statistics are indispensable. Prior to any RDD estimation, it is imperative to conduct a <strong>graphical analysis</strong> to justify the credibility of the chosen strategy. The graphical representation should demonstrate a <strong>notable jump in the outcome and treatment assignment at the threshold</strong>, attributable to the treatment.</p>
<p>For this purpose, one can plot the relationship between (i) treatment assignment and the running variable, between (ii) the outcome and running variable, (iii) between control variables and running variable, and (iv) the density of the running variable. The latter provides justification for the <strong>absence of manipulation of the running variable</strong> and is often done as a robustness check (see replication of Figure A2 below for more details).</p>
<p>In what follows, you will replicate Figure 4, which plots the relationship between the running variable (<em>Sisbén</em> score, centered at the cutoff, variable “sisben”) and the outcome variable (ranking change, variable “ranking”). It provides a graphical representation of the RDD estimators on average effect, and at the 25th, 50th, 75th, 90th percentile. It shows evidence of the presence of a discontinuity at the threshold, and offers insights for a significant effect from the 75th percentile only.</p>
<p>The code is quite imposing and can be discouraging. <strong>Let’s not get ourselves intimidated</strong> and break the code step by step.</p>
<div id="step-1---data-preparation-defining-some-scalars-and-creating-bins" class="section level5 unnumbered hasAnchor">
<h5>Step 1 - Data preparation: defining some scalars and creating bins<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#step-1---data-preparation-defining-some-scalars-and-creating-bins" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The <code>scalar x</code> command stores a single numeric value into a scalar named x. Scalars are useful to hold numerical outcomes, constants, or intermediate results of computations without creating new variables. The command <code>scalar drop _all</code> deletes any scalar Stata has in memory, and can be used prior to any new computation.</p>
<p>You will first use scalars to set the width of bins, as well as the value of the CERSUM optimal bandwidth (by Calonico et al. 2014) to 3.35. The optimal bandwidth restricts the regression to the subsample of students whose distance between the <em>Sisbén</em> score and the need-based eligibility cutoff is inferior to 3.35.</p>
<blockquote>
<p><strong>Focus on bandwidths</strong> Bandwidths are employed to define a specific data window around the cutoff in order to compare eligible students to non-eligible ones. The authors apply the CERSUM (Coverage Error-Rate Optimal Bandwidths) optimal bandwidth suggested by <a href="https://doi.org/10.3982/ECTA11757" target="_blank">Calonico et al. (2014)</a>. Coverage error is a type of non-sampling error that occurs when there is not a one-to-one correspondence between the target population and the sampling frame from which a sample is drawn. This can lead to violations of the Regression Discontinuity assumptions, and bias estimates calculated using survey data. CERSUM bandwidths are chosen to minimize the probability that the confidence interval for the regression discontinuities treatment effect does not contain the true effect. It thus allows for bias-corrected robust confidence intervals for the average treatment effect at the cutoff.</p>
</blockquote>
<blockquote>
<p>In Stata, the computation of these CERSUM optimal bandwidths can be done using the package <code>rdrobust</code> introduced by <a href="https://doi.org/10.3982/ECTA11757" target="_blank">Calonico et al. (2014)</a>.</p>
</blockquote>
<p>For more details about bandwidth calculation, you can look at the code in Section 4.1.5.</p>
<p>In the context of a RDD graph, bins refer to intervals along the running variable in which observations are grouped for visualization or analysis. Each bin represents a range of values around the threshold. Here, bins of two different sizes are defined.</p>
<div class="sourceCode" id="cb85" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb85-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb85-1" tabindex="-1"></a><span class="fu">scalar</span> <span class="kw">drop</span> <span class="dt">_all</span></span>
<span id="cb85-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb85-2" tabindex="-1"></a><span class="fu">scalar</span> bw_dif_cersum =  3.3502511</span>
<span id="cb85-3"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb85-3" tabindex="-1"></a><span class="fu">scalar</span> small_binsize = .01 </span>
<span id="cb85-4"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb85-4" tabindex="-1"></a><span class="fu">scalar</span> large_binsize = .3</span>
<span id="cb85-5"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb85-5" tabindex="-1"></a><span class="kw">set</span> <span class="dv">seed</span> 1984</span></code></pre></div>
<p>The <code>set seed</code> command is used to set the seed for the random number generator, ensuring that Stata produces the same sequence of random numbers (here 1984) every time the program is run.</p>
<p>Use the <code>keep if</code> command to keep only observations for which the absolute value of the running variable (distance between student’s <em>Sisbén</em> score and the need-based eligibility cutoff) is inferior to 3.35 (<code>scalar bw_dif_cersum</code>), that is keep only the need-based eligible.</p>
<div class="sourceCode" id="cb86" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb86-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb86-1" tabindex="-1"></a><span class="kw">keep</span> <span class="kw">if</span> <span class="fu">abs</span>(sisben)&lt;bw_dif_cersum </span></code></pre></div>
<p>Create a variable “pre” using the command gen, that is the opposite of the variable post. It is equal to 1 for students who passed the Saber 11 exam in 2015 before and didn’t benefit from the SPP.</p>
<div class="sourceCode" id="cb87" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb87-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb87-1" tabindex="-1"></a><span class="kw">gen</span> pre = (<span class="kw">post</span> == 0) </span></code></pre></div>
<p>You can then generate bins that will appear in the graph. In an RDD graph, observations are often grouped into bins based on their values on the assignment variable. The graph displays the average ranking in the Saber 11 for each bin.</p>
<div class="sourceCode" id="cb88" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb88-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb88-1" tabindex="-1"></a><span class="kw">gen</span> large_bins = <span class="fu">round</span>(sisben + large_binsize/2, large_binsize) - large_binsize/2 <span class="kw">if</span> <span class="fu">abs</span>(sisben)&lt;bw_dif_cersum  </span>
<span id="cb88-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb88-2" tabindex="-1"></a><span class="kw">gen</span> small_bins = <span class="fu">round</span>(sisben,small_binsize) <span class="co">// Each small bin is set to 0.01 around the sisben score for each individual. </span></span></code></pre></div>
</div>
<div id="step-2---prepare-the-ols-average-estimation-depicted-in-the-graph" class="section level5 unnumbered hasAnchor">
<h5>Step 2 - Prepare the OLS (average) estimation depicted in the graph<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#step-2---prepare-the-ols-average-estimation-depicted-in-the-graph" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>You will prepare in this section the main regression to be represented in the OLS graph, and the percentiles.</p>
<p>Firstly, regress (using the command <code>reg dependant independents, robust</code>) the ranking in <em>Saber</em> score (outcome) according to control variables and passing the <em>Saber</em> exam after the implementation of SPP. You will then have to save the <strong>residuals of this regression</strong>, creating a variable <em>resid_ols</em>. The predict command always refers to the last regression Stata has in memory. You have to specify after the comma what you want to predict.
For clearer and less heavy regressions, don’t forget to define a <code>global</code> with all your controls of interest. This avoids having to rewrite the full list of covariates in every regression.</p>
<div class="sourceCode" id="cb89" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb89-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb89-1" tabindex="-1"></a><span class="kw">global</span> controls cities other_urban father_educ_prim father_educ_second father_educ_high mother_educ_prim mother_educ_second mother_educ_high age sex department_1-department_32 saber_avg_school <span class="co">/*if not done yet*/</span></span>
<span id="cb89-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb89-2" tabindex="-1"></a><span class="kw">reg</span> ranking <span class="ot">${controls}</span> <span class="kw">post</span>, <span class="kw">robust</span> </span>
<span id="cb89-3"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb89-3" tabindex="-1"></a><span class="kw">predict</span> resid_ols, residuals </span></code></pre></div>
<p>The next step is to compute <strong>local percentiles</strong>. This is done in 2 stages:</p>
<p><strong>Stage 1</strong>: Compute means of the outcome variable and residuals</p>
<p>Using a loop, compute means for the variables <em>ranking</em> and <em>resid_ols</em>, within subsets defined by the variables <em>small_bins</em> and <em>large_bins</em>, for two time periods (pre and post). It creates new variables for each combination of time period, variable, and subset. For examples:</p>
<ul>
<li><p><em>ranking_ols_pre</em> is the mean of ranking within each small bin, before the introduction of SPP.</p></li>
<li><p><em>ranking_ols_r_pre</em> is the mean of the residuals (of the regression of ranking on post) within each small bin, before the introduction of SPP.</p></li>
<li><p><em>ranking_ols_r_largeb_post</em> is the mean of the residuals within each bin, before the introduction of SPP.</p></li>
</ul>
<div class="sourceCode" id="cb90" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb90-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb90-1" tabindex="-1"></a><span class="kw">foreach</span> t <span class="kw">in</span> pre <span class="kw">post</span> {</span>
<span id="cb90-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb90-2" tabindex="-1"></a><span class="kw">bysort</span> small_bins: <span class="kw">egen</span> ranking_ols_<span class="ot">`t&#39;</span>= <span class="kw">mean</span>(ranking) <span class="kw">if</span> <span class="ot">`t&#39;</span>==1 </span>
<span id="cb90-3"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb90-3" tabindex="-1"></a><span class="kw">bysort</span> small_bins: <span class="kw">egen</span> ranking_ols_r_<span class="ot">`t&#39;</span>= <span class="kw">mean</span>(resid_ols) <span class="kw">if</span> <span class="ot">`t&#39;</span>==1  </span>
<span id="cb90-4"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb90-4" tabindex="-1"></a><span class="kw">bysort</span> large_bins: <span class="kw">egen</span> ranking_ols_r_largeb_<span class="ot">`t&#39;</span>= <span class="kw">mean</span>(resid_ols)  if<span class="ot">`t&#39;</span>==1</span>
<span id="cb90-5"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb90-5" tabindex="-1"></a>}</span></code></pre></div>
<p>A loop repeats the same lines of code for different values of a specified variable, here for each value of pre and post. It allows you to save time, by avoiding copying and pasting the exact same code for different variables. Don’t forget to open the bracket at the end of the first line after specifying the variable to repeat the loop on, to return to line to write your code, and to return to another line to close the bracket.
The command <code>bysort</code> tells Stata to apply an operation (here creating means) separately for each value taken by the variable <em>small_bins.</em> Please note that to compute means, you have to use the command <code>egen</code> and not <code>gen</code>.</p>
<p><strong>Stage 2</strong>: Adjust for the constant, so that the average is the same as the data</p>
<p>You will calculate means for the variables computed in stage 1 (<em>ranking_ols_r_pre</em>, <em>ranking_ols_r_post</em>, <em>ranking_ols_r_largeb_pre</em>, <em>ranking_ols_r_largeb_post</em>), and then adjust the values of those variables based on the differences between the mean of the original variable (<em>ranking</em>) and the calculated means on residuals. You can notice here that you can include several loops within the first one:</p>
<div class="sourceCode" id="cb91" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb91-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb91-1" tabindex="-1"></a><span class="kw">foreach</span> t <span class="kw">in</span> pre <span class="kw">post</span> {</span>
<span id="cb91-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb91-2" tabindex="-1"></a><span class="kw">foreach</span> x <span class="kw">in</span> ranking_ols_r_<span class="ot">`t&#39;</span> ranking_ols_r_largeb_<span class="ot">`t&#39;</span> {</span>
<span id="cb91-3"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb91-3" tabindex="-1"></a><span class="kw">quietly</span> sum<span class="ot">`x&#39;</span>if <span class="ot">`t&#39;</span> == 1 <span class="co">//This quietly calculates the mean of each variable within each group for the specified time period. </span></span>
<span id="cb91-4"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb91-4" tabindex="-1"></a><span class="fu">scalar</span> m_<span class="ot">`x&#39;</span> = <span class="fu">r</span>(<span class="kw">mean</span>) <span class="co">//Store the previous mean in a scalar (m_`x&#39;)</span></span>
<span id="cb91-5"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb91-5" tabindex="-1"></a><span class="kw">quietly</span>  sumranking <span class="kw">if</span> <span class="ot">`t&#39;</span> == 1  <span class="co">// This calculates the mean of ranking within each group for the specified time period.</span></span>
<span id="cb91-6"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb91-6" tabindex="-1"></a><span class="fu">scalar</span> ols_ranking = <span class="fu">r</span>(<span class="kw">mean</span>) <span class="co">// Store the previous mean in a scalar (ols_ranking)</span></span>
<span id="cb91-7"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb91-7" tabindex="-1"></a><span class="fu">scalar</span> dify = ols_ranking - m_<span class="ot">`x&#39;</span><span class="co">// This calculates the difference between the mean of the original ranking variable and the mean of the residuals variables.</span></span>
<span id="cb91-8"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb91-8" tabindex="-1"></a><span class="kw">replace</span> <span class="ot">`x&#39;</span> = <span class="ot">`x&#39;</span> + dify <span class="kw">if</span> <span class="ot">`t&#39;</span> == 1 <span class="co">// Replace the values of the variables by their adjusted values based on the calculated difference</span></span>
<span id="cb91-9"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb91-9" tabindex="-1"></a>}</span>
<span id="cb91-10"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb91-10" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="step-3---prepare-the-quantile-estimations-depicted-in-the-graph" class="section level5 unnumbered hasAnchor">
<h5>Step 3 - Prepare the quantile estimations depicted in the graph<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#step-3---prepare-the-quantile-estimations-depicted-in-the-graph" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>With a loop , you can run the same code as in the OLS estimation, on each quantile (<code>foreach q in 25 50 75 90</code>) ; that is regress the ranking in <em>Saber</em> score according to controls and passing the Saber exam after the implementation of SPP ; calculation of local percentiles ; and adjust for the constant.</p>
<p>You have to be careful though, when running quantile regression, that Stata is able to compute enough iterations. In quantile regression, the estimation procedure follows a numerical minimization procedure through the simplex method: the algorithm repeats computations to find parameter estimates minimizing the objective loss function. To make sure Stata will compute enough iterations, we suggest you to set the maximum number of iterations to 1000 with the command <code>set maxiter 1000</code>.</p>
</div>
<div id="step-4---collapse-data-to-keep-only-one-observation-per-bin" class="section level5 unnumbered hasAnchor">
<h5>Step 4 - Collapse data to keep only one observation per bin<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#step-4---collapse-data-to-keep-only-one-observation-per-bin" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>It is frequent using quantiles that multiple observations take the same value. Instead of counting them as one observation, each of the observations is assigned a weight. For example, if you have three observations taking the same value, counting them as one observation and assigning them a weight of 3 reflects the fact that these three observations contribute to the percentile calculation. One will be used for counting and then weight based on the number of observations used to calculate the percentile.</p>
<p>First of all, for predictions, you need to replace each control by its average value:</p>
<div class="sourceCode" id="cb92" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb92-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb92-1" tabindex="-1"></a><span class="kw">foreach</span> x <span class="kw">in</span> cities other_urban father_educ_prim father_educ_second father_educ_high mother_educ_prim mother_educ_second mother_educ_high age sex saber_rk_col department_1 department_2 department_3 department_4 department_5 department_6 department_7 department_8 department_9 department_10 department_11 department_12 department_13 department_14 department_15 department_16 department_17 department_18 department_19 department_20 department_21 department_22 department_23 department_24 department_25 department_26 department_27 department_28 department_29 department_30 department_31 department_32 {</span>
<span id="cb92-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb92-2" tabindex="-1"></a><span class="kw">quietly</span>  sum<span class="ot">`x&#39;</span><span class="co">//This quietly calculates the mean of each control</span></span>
<span id="cb92-3"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb92-3" tabindex="-1"></a><span class="fu">scalar</span> aux = <span class="fu">r</span>(<span class="kw">mean</span>) <span class="co">//Store the previous results in the scalar &quot;aux&quot;.</span></span>
<span id="cb92-4"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb92-4" tabindex="-1"></a><span class="kw">quietly</span>  replace<span class="ot">`x&#39;</span> = aux <span class="co">//Replace each control variable by its mean value.</span></span>
<span id="cb92-5"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb92-5" tabindex="-1"></a>}</span></code></pre></div>
<p>Then you will create binary indicator variables (“one_pre” and “one_post”) that take the value 1 for observations corresponding to the specified time periods (pre or post, that is if t==1) and 0 for all other observations.</p>
<div class="sourceCode" id="cb93" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb93-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb93-1" tabindex="-1"></a><span class="kw">foreach</span> t <span class="kw">in</span> pre <span class="kw">post</span> {</span>
<span id="cb93-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb93-2" tabindex="-1"></a><span class="kw">gen</span> one_<span class="ot">`t&#39;</span> = 1 <span class="kw">if</span> <span class="ot">`t&#39;</span> == 1</span>
<span id="cb93-3"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb93-3" tabindex="-1"></a>}</span></code></pre></div>
<p>Finally, collapse by bins, in order to keep only one observation per bin, which makes you avoid artificial significance through repetition of observations:</p>
<div class="sourceCode" id="cb94" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb94-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb94-1" tabindex="-1"></a><span class="kw">collapse</span> ranking_*sisben large_bins eligible_post eligible <span class="kw">post</span> sisben_eligible sisben_post sisben_eligible_post <span class="ot">${controls}</span> (<span class="fu">count</span>) one_pre one_post, <span class="kw">by</span>(small_bins)</span></code></pre></div>
<p>You should end up with only 675 observations, one for each unique value of small bins.</p>
<p>For each of the residuals variables, you then have to generate a variable equal to the difference between their pre and post value. We do so in the OLS average and in the quantile estimations using a loop. This is the code for the OLS loop:</p>
<div class="sourceCode" id="cb95" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb95-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb95-1" tabindex="-1"></a><span class="kw">foreach</span> x <span class="kw">in</span> ranking_ols_r_ ranking_ols_r_largeb_ {</span>
<span id="cb95-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb95-2" tabindex="-1"></a><span class="kw">gen</span> <span class="ot">`x&#39;</span>dif = <span class="ot">`x&#39;</span>post - <span class="ot">`x&#39;</span>pre </span>
<span id="cb95-3"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb95-3" tabindex="-1"></a>}</span></code></pre></div>
<p>Don’t forget to save the database you just created in a new file. It is important to never delete the original database. You rather want to save your modifications in a separate file.</p>
<div class="sourceCode" id="cb96" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb96-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb96-1" tabindex="-1"></a>save<span class="st">&quot;bybeans_pre_post_dif.dta&quot;</span>, <span class="kw">replace</span> </span></code></pre></div>
</div>
<div id="step-5---construct-the-ols-average-graph-and-its-confidence-intervals" class="section level5 unnumbered hasAnchor">
<h5>Step 5 - Construct the OLS average graph and its confidence intervals<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#step-5---construct-the-ols-average-graph-and-its-confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>We are getting closer to creating the graph! Once again, let’s decompose into several stages. By the end of these stages, you should have the following .png output of Figure 4:</p>
<p><img src="resources/LMS/image4.png" /></p>
<p><strong>Stage 1</strong>: Main regression to display in the graph
Use the original dataset to run this regression.</p>
<div class="sourceCode" id="cb97" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb97-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb97-1" tabindex="-1"></a><span class="kw">reg</span> ranking eligible_post eligible <span class="kw">post</span> sisben sisben_eligible sisben_post sisben_eligible_post <span class="ot">${controls}</span> <span class="kw">if</span> <span class="fu">abs</span>(sisben)&lt;bw_dif_cersum, ro</span></code></pre></div>
<p>Stage 2: Data preparation for the confidence intervals
Here, use the second dataset you created (the one processed by bins).</p>
<p>Interacting a variable with <em>post</em> restricts the estimation on the sample of students who passed the <em>Saber 11</em> exam in 2015, 10 months after the implementation of SPP. The regression in discontinuities design compares treated and untreated students (on both sides of the threshold) before (<em>post</em>=0, 2014 cohort) and after the implementation of SPP (<em>post</em>=1, 2015 cohort).</p>
<p>However, in order to represent the discontinuity effect graphically and construct confidence intervals, you have to get rid of this temporal dimension. The setting shifts closely to a standard RDD representation that solely depicts the relation between the running variable determining the eligibility to SPP and the output variable (<em>ranking</em>), independently of the year students passed their <em>Saber 11</em> exam and benefited from SPP.</p>
<p>To do so, the authors suppress the interaction with the <em>post</em> variable. They replace each variable that is interacted with <em>post</em>, by the corresponding simple non-interacted variable.
For instance, they attribute the values of the <em>eligible</em> variable to the <em>eligible_post</em> variable. The variable of interest (initially <em>eligible_post</em> - that is whether students are eligible to the scholarship and pass the <em>Saber 11</em> exam in 2015) is translated to simply being eligible to the scholarship. It now estimates the effect of being eligible to SPP on the ranking in the <em>Saber 11</em> exam, independently from whether students benefited from SPP two or ten months before writing the <em>Saber 11</em> exam.</p>
<div class="sourceCode" id="cb98" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb98-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb98-1" tabindex="-1"></a><span class="kw">replace</span> eligible_post = eligible </span>
<span id="cb98-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb98-2" tabindex="-1"></a><span class="kw">replace</span> sisben_post = sisben  </span>
<span id="cb98-3"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb98-3" tabindex="-1"></a><span class="kw">replace</span> sisben_eligible_post = sisben_eligible </span></code></pre></div>
<p><em>post</em>, <em>eligible</em>, <em>sisben</em>, and <em>sisben_eligible</em> are now present twice in the dataset, once under their original name, and a second time under their post interaction name (that you just modified the value). You now want to set the values of the original variables to 0 to avoid multicollinearity in the regression.</p>
<div class="sourceCode" id="cb99" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb99-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb99-1" tabindex="-1"></a><span class="kw">foreach</span> x <span class="kw">in</span> <span class="kw">post</span> eligible sisben sisben_eligible {</span>
<span id="cb99-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb99-2" tabindex="-1"></a>replace<span class="ot">`x&#39;</span> = 0</span>
<span id="cb99-3"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb99-3" tabindex="-1"></a>}</span></code></pre></div>
<p>Stage 3: Predicted values of the main regression
Using the <code>predict</code> command, you will calculate linear predicted values from the regression above (creating a new variable <em>yh_ols</em>); as well as standard errors of the prediction <code>xb</code> (saving them in a new variable <em>y_stdp_ols</em>)</p>
<div class="sourceCode" id="cb100" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb100-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb100-1" tabindex="-1"></a><span class="kw">predict</span> yh_ols, <span class="kw">xb</span>  </span>
<span id="cb100-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb100-2" tabindex="-1"></a><span class="kw">predict</span> y_stdp_ols, stdp </span></code></pre></div>
<p>Stage 4: Adjustment for the constant
You want here to adjust the values <em>yh_ols</em> variable, so that the average is the same as the <code>q'th percentile. To do so, you need to add to each observation of the *yh_ols* variable the calculated average difference between mean of *ranking_ols_r_dif* and mean of *yh_ols.*  Note that with many commands, you can also use the</code>quietly` command when you don’t want Stata to show the results.</p>
<div class="sourceCode" id="cb101" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb101-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb101-1" tabindex="-1"></a><span class="kw">quietly</span>  <span class="kw">sum</span> yh_ols <span class="co">// Calculate mean for the variable yh_ols</span></span>
<span id="cb101-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb101-2" tabindex="-1"></a><span class="fu">scalar</span> m_yh_ols = <span class="fu">r</span>(<span class="kw">mean</span>) <span class="co">// Store the previous results in a scaler (m_yh_ols) </span></span>
<span id="cb101-3"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb101-3" tabindex="-1"></a><span class="kw">quietly</span>  <span class="kw">sum</span> ranking_ols_r_dif <span class="co">// Calculate mean for the variable ranking_ols_r_dif</span></span>
<span id="cb101-4"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb101-4" tabindex="-1"></a><span class="fu">scalar</span> ols_ranking_dif = <span class="fu">r</span>(<span class="kw">mean</span>) <span class="co">// Store the previous results in a scaler (ols_ranking_dif)</span></span>
<span id="cb101-5"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb101-5" tabindex="-1"></a><span class="fu">scalar</span> dify = ols_ranking_dif - m_yh_ols <span class="co">// Calculate the difference between the mean of ranking_ols_r_dif and the mean of yh_ols and store it in the scalar (dify)</span></span>
<span id="cb101-6"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb101-6" tabindex="-1"></a><span class="kw">replace</span> yh_ols = yh_ols + dify <span class="co">// Adding the calculated difference to each observation</span></span></code></pre></div>
<p>Stage 5: Compute confidence intervals
Create here two new variables for the lower and upper bound of the confidence intervals, taking missing values for each observation, and then attribute values to the CI bounds, to estimate confidence intervals at the 95% level. For each small and large bin, the value of the higher bound of the confidence interval is equal to: (the coefficient estimates - 1.96 * the standard error estimated).</p>
<div class="sourceCode" id="cb102" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb102-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb102-1" tabindex="-1"></a><span class="kw">gen</span> ci_h_ols=. </span>
<span id="cb102-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb102-2" tabindex="-1"></a><span class="kw">gen</span> ci_l_ols=.</span>
<span id="cb102-3"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb102-3" tabindex="-1"></a><span class="kw">replace</span> ci_h_ols = yh_ols+1.96*y_stdp_ols  </span>
<span id="cb102-4"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb102-4" tabindex="-1"></a><span class="kw">replace</span> ci_l_ols=yh_ols-1.96*y_stdp_ols </span></code></pre></div>
<p>Stage 6: Create the graph!
One particularity of this RDD design is the linear fit on each side of the threshold. Within this framework, you want to attribute the values of the variable <em>small_bins</em> to <em>sisben.</em></p>
<div class="sourceCode" id="cb103" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb103-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb103-1" tabindex="-1"></a><span class="kw">replace</span> sisben = small_bins </span></code></pre></div>
<p>Using the <code>twoway</code> command, you will create a scatter plot, displaying the relationship between ranking in the <em>Saber 11</em> and the <em>Sisbén</em> score at the cutoff.
In the command <code>scatter</code> (and within the same brackets) you can specify options after a comma to define the symbol to employ and its color (<code>msymbol</code> and <code>mcolor</code>).
You can also add lines in your scatter plot, using the command <code>line</code>, and specify options after a comma to define the style, pattern and color of the line (<code>pstyle</code>, <code>lpattern</code> and <code>lcolor</code>). For instance, here, we add a line plot of <em>ci_l_ols</em> against <em>small_bins</em> for cases where <em>sisben</em> is inferior to 0. The line has point-style (p3 p3), a dashed line pattern, is sorted, and has green color.</p>
<p>Once you have indicated all elements to draw in the <code>twoway graph</code>, add a comma and write the options of the graph: its title, y and x-axis titles, legend settings, and design options (style and color of the graph region, background color of the graph).</p>
<div class="sourceCode" id="cb104" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb104-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb104-1" tabindex="-1"></a><span class="kw">twoway</span>(<span class="kw">scatter</span> ranking_ols_r_largeb_dif large_binsif large_bins == small_bins, <span class="bn">msymbol</span>(O) mcolor(<span class="bn">gray</span>)) </span>
<span id="cb104-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb104-2" tabindex="-1"></a> (<span class="kw">line</span> yh_ols small_bins <span class="kw">if</span> sisben &lt;0, pstyle(<span class="kw">p</span>) <span class="kw">sort</span> lcolor(<span class="bn">blue</span>))</span>
<span id="cb104-3"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb104-3" tabindex="-1"></a> (<span class="kw">line</span> ci_l_ols small_bins <span class="kw">if</span> sisben &lt;0, pstyle(p3 p3) lpattern(<span class="kw">dash</span>) <span class="kw">sort</span>  lcolor(<span class="kw">green</span>)) </span>
<span id="cb104-4"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb104-4" tabindex="-1"></a> (<span class="kw">line</span> ci_h_ols small_bins <span class="kw">if</span> sisben &lt;0, pstyle(p3 p3) lpattern(<span class="kw">dash</span>) <span class="kw">sort</span> lcolor(<span class="kw">green</span>)) </span>
<span id="cb104-5"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb104-5" tabindex="-1"></a> (<span class="kw">line</span> yh_ols small_bins <span class="kw">if</span> sisben &gt;0, pstyle (<span class="kw">p</span>) <span class="kw">sort</span> lcolor(<span class="bn">blue</span>)) </span>
<span id="cb104-6"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb104-6" tabindex="-1"></a>(<span class="kw">line</span>  ci_l_ols  small_bins <span class="kw">if</span> sisben &gt;0, pstyle (p3 p3) lpattern(<span class="kw">dash</span>) <span class="kw">sort</span> lcolor(<span class="kw">green</span>)) </span>
<span id="cb104-7"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb104-7" tabindex="-1"></a>(<span class="kw">line</span> ci_h_ols small_bins <span class="kw">if</span> sisben &gt;0, pstyle (p3 p3) lpattern(<span class="kw">dash</span>) <span class="kw">sort</span> lcolor(<span class="kw">green</span>)), </span>
<span id="cb104-8"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb104-8" tabindex="-1"></a><span class="bn">ytitle</span>(<span class="st">&quot;Ranking change in average&quot;</span> <span class="st">&quot; &quot;</span>) </span>
<span id="cb104-9"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb104-9" tabindex="-1"></a><span class="bn">xtitle</span>(<span class="st">&quot;Eligible Not Eligible&quot;</span> <span class="st">&quot; &quot;</span> <span class="st">&quot;{it:Sisbén} score (centered at cutoff)&quot;</span>) </span>
<span id="cb104-10"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb104-10" tabindex="-1"></a><span class="bn">legend</span>(<span class="kw">label</span>(1 <span class="st">&quot;Change by bin&quot;</span>) <span class="kw">label</span>(2 <span class="st">&quot;Dif in RD linear prediction&quot;</span>) <span class="kw">label</span>(3 <span class="st">&quot;95% CI of linear prediction&quot;</span>) <span class="kw">order</span>(2 1 3)) </span>
<span id="cb104-11"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb104-11" tabindex="-1"></a><span class="bn">title</span>(Average Effect) </span>
<span id="cb104-12"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb104-12" tabindex="-1"></a>graphregion(style(<span class="kw">none</span>) <span class="kw">color</span>(gs16))</span>
<span id="cb104-13"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb104-13" tabindex="-1"></a>bgcolor(<span class="bn">white</span>) </span>
<span id="cb104-14"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb104-14" tabindex="-1"></a><span class="bn">xline</span>(0, lcolor(<span class="kw">red</span>)) </span>
<span id="cb104-15"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb104-15" tabindex="-1"></a><span class="bn">name</span>(DifRD_ols, <span class="kw">replace</span>) </span></code></pre></div>
<p>Step 7: Export the graph into the format of your choice, here .png.</p>
<p>You just replicated one of the elements of Figure 4!</p>
<div class="sourceCode" id="cb105" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb105-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb105-1" tabindex="-1"></a><span class="kw">graph</span> <span class="kw">export</span> <span class="st">&quot;DIf_RD_Fig_Lin_ols.png&quot;</span>, <span class="kw">replace</span> </span></code></pre></div>
</div>
<div id="step-6---construct-the-quantile-graphs-and-their-confidence-intervals" class="section level5 unnumbered hasAnchor">
<h5>Step 6 - Construct the quantile graphs and their confidence intervals<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#step-6---construct-the-quantile-graphs-and-their-confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>We redo the same procedure as in the OLS estimation (steps 1 to 7), with a loop to get one graph for each quantile (download our do-file in section Highlights for details).</p>
<p>At this stage of the replication exercise, you should have four .png outputs of Figure 4, one for each quantile (as the output below for the 25th percentile).</p>
<p><img src="resources/LMS/image5.png" /></p>
</div>
<div id="step-7---merge-the-five-graphs-into-one-figure-using-the-grc1leg-package" class="section level5 unnumbered hasAnchor">
<h5>Step 7 - Merge the five graphs into one figure using the grc1leg package<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#step-7---merge-the-five-graphs-into-one-figure-using-the-grc1leg-package" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>To be able to use the grc1leg command, you probably have to install the package. However, the package is not provided by the Sata package library. You have to import it directly from its author, <a href="https://www.stata.com/users/vwiggins/grc1leg/grc1leg.ado" target="_blank">Vince Wiggins (2010)</a>.</p>
<div class="sourceCode" id="cb106" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb106-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb106-1" tabindex="-1"></a>net install grc1leg, from (http:<span class="co">//www.stata.com/users/vwiggins) </span></span></code></pre></div>
<p>You will first merge the three first graphs on a single-row graph named <em>row1</em>, then the two remaining ones on another single-row graph named <em>row2</em>. We finally merge <em>row1</em> and <em>row2</em> in a single one column graph.</p>
<div class="sourceCode" id="cb107" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb107-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb107-1" tabindex="-1"></a>grc1leg DifRD_ols DifRD_25 DifRD_50, <span class="bn">rows</span>(1) <span class="bn">name</span>(row_1, <span class="kw">replace</span>) graphregion(<span class="kw">color</span>(<span class="bn">white</span>)) </span>
<span id="cb107-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb107-2" tabindex="-1"></a>grc1leg DifRD_75 DifRD_90, <span class="bn">rows</span>(1) <span class="bn">name</span>(row_2, <span class="kw">replace</span>) graphregion(<span class="kw">color</span>(<span class="bn">white</span>)) </span>
<span id="cb107-3"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb107-3" tabindex="-1"></a>grc1leg row_1 row_2, <span class="bn">cols</span>(1) graphregion(<span class="kw">color</span>(<span class="bn">white</span>)) </span>
<span id="cb107-4"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb107-4" tabindex="-1"></a></span>
<span id="cb107-5"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb107-5" tabindex="-1"></a><span class="kw">graph</span> export<span class="st">&quot;figure_4.png&quot;</span>, <span class="kw">replace</span></span></code></pre></div>
<p>At the end of this part of this replication exercise, you should have the following .png output of Figure 4:</p>
<p><img src="resources/LMS/image6.png" /></p>
</div>
</div>
</div>
<div id="main-results---replication-of-table-3" class="section level3 hasAnchor" number="4.1.5">
<h3><span class="header-section-number">4.1.5</span> Main results - Replication of Table 3<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#main-results---replication-of-table-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In their main results, the model they estimate is the following (based on Grembi et al, 2016):</p>
<p><span class="math display">\[\begin{equation}
\tag{1}
Ranking_{it} = β_{0} + β_{1} eligible\_post_{it} + β_{2} eligible_{i} + β_{3} sisben_{i} + β_{4} sisben\_eligible_{i} + β_{5} sisben\_post_{it} + β_{6} sisben\_eligible\_post_{it} + X_{it} α + ϵ_{it}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(Ranking_{it}\)</span> is the dependent variable, the rank (from 0 to 100) on the <em>Saber 11</em> exam of student <span class="math inline">\(i\)</span> who passed the test in year <span class="math inline">\(t\)</span>, <span class="math inline">\(β_{1}\)</span> is the difference-in-discontinuities estimate (our coefficient of interest, the change in discontinuity in test scores before and after the introduction of SPP), and <span class="math inline">\(sisben_{i}\)</span> is the running variable.</p>
<p>Table 3 summarizes the main results of the paper from the above equation. The first column reports the results estimated with the regression-in-discontinuities specification (mean effect) while the columns 3 to 5 report the results obtained with quantile regressions.</p>
<p>At the end of this part of this replication exercise, you should have the following .xls output of Table 3:</p>
<p><img src="resources/LMS/image7.png" /></p>
<div id="step-1---bandwidths-calculation" class="section level4 unnumbered hasAnchor">
<h4>Step 1 - Bandwidths calculation<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#step-1---bandwidths-calculation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Before running this regression, it is necessary to define a bandwidth around the cutoff to compare eligible students to non-eligible ones.</p>
<blockquote>
<p>Focus on bandwidths - The authors apply the CERSUM (Coverage Error-Rate Optimal Bandwidths) optimal bandwidth suggested by <a href="https://doi.org/10.3982/ECTA11757" target="_blank">Calonico et al. (2014)</a>. Coverage error is a type of non-sampling error that occurs when there is not a one-to-one correspondence between the target population and the sampling frame from which a sample is drawn. This can lead to violations of the Regression Discontinuity assumptions, and bias estimates calculated using survey data. CERSUM bandwidths are chosen to minimize the probability that the confidence interval for the regression discontinuities treatment effect does not contain the true effect. It thus allows for bias-corrected robust confidence intervals for the average treatment effect at the cutoff.</p>
</blockquote>
<p>In our case, the optimal bandwidth restricts the regression to the subsample of students whose distance between the <em>Sisbén</em> score and the need-based eligibility cutoff is inferior to 3.35.</p>
<p>In Stata, the computation of these CERSUM optimal bandwidths can be done using the package <code>rdrobust</code> introduced by Calonico et al.(2014).</p>
<p>First you will have to install the package rdrobust.</p>
<div class="sourceCode" id="cb108" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb108-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb108-1" tabindex="-1"></a><span class="kw">ssc</span> install rdrobust</span></code></pre></div>
<p>Then, to get the CERSUM optimal bandwidths, you will:</p>
<ul>
<li>Calculate it for pre-period (year 2013 and 2014, <em>post</em>=0) with the regression discontinuity analysis command <code>rdrobust</code>, using the uniform kernel function:</li>
</ul>
<div class="sourceCode" id="cb109" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb109-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb109-1" tabindex="-1"></a>*pre cersum:</span>
<span id="cb109-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb109-2" tabindex="-1"></a>rdrobust ranking sisben <span class="kw">if</span> <span class="kw">post</span> == 0, kernel(uniform) bwselect(cersum)</span></code></pre></div>
<ul>
<li>Create a scalar variable and assign it to the value of the estimated bandwidth stored in <code>e(h_l)</code></li>
</ul>
<div class="sourceCode" id="cb110" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb110-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb110-1" tabindex="-1"></a><span class="fu">scalar</span> bw_pre_cersum = <span class="fu">e</span>(h_l) </span></code></pre></div>
<ul>
<li>Do the same for the post-period (<em>post</em>=1)</li>
</ul>
<div class="sourceCode" id="cb111" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb111-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb111-1" tabindex="-1"></a>*<span class="kw">post</span> cersum:</span>
<span id="cb111-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb111-2" tabindex="-1"></a>rdrobust ranking sisben <span class="kw">if</span> <span class="kw">post</span> == 1, kernel(uniform) bwselect(cersum)</span>
<span id="cb111-3"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb111-3" tabindex="-1"></a><span class="fu">scalar</span> bw_post_cersum = <span class="fu">e</span>(h_l) </span></code></pre></div>
<ul>
<li>Create a scalar variable and assign it to the mean of both above calculated bandwidths.</li>
</ul>
<div class="sourceCode" id="cb112" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb112-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb112-1" tabindex="-1"></a><span class="fu">scalar</span> bw_dif_cersum = (bw_pre_cersum +bw_post_cersum)/2 </span></code></pre></div>
<ul>
<li>To see the resulting bandwidths estimation, use <code>scalar list _all</code></li>
</ul>
<p>Once you have done this computation a first time and obtained the optimal bandwidth value (3.35 in our case), you can simply store this value in a scalar for simplicity. This avoids you redoing the complete computation every time you want to use it.</p>
<div class="sourceCode" id="cb113" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb113-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb113-1" tabindex="-1"></a><span class="fu">scalar</span> bw_dif_cersum = 3.3502511</span></code></pre></div>
<p>Then, set a global for the control variables required in this regression.</p>
<div class="sourceCode" id="cb114" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb114-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb114-1" tabindex="-1"></a><span class="kw">global</span> controls cities other_urban father_educ_prim father_educ_second father_educ_high mother_educ_prim mother_educ_second mother_educ_high age sex department_1-department_32 saber_rk_col</span></code></pre></div>
</div>
<div id="step-2---regression-at-the-eligibility-cutoff-and-saving-the-results-with-outreg2-command" class="section level4 unnumbered hasAnchor">
<h4>Step 2 - Regression at the eligibility cutoff and saving the results with outreg2 command<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#step-2---regression-at-the-eligibility-cutoff-and-saving-the-results-with-outreg2-command" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You will regress, at the eligibility cutoff, the ranking in the <em>Saber 11</em> (variable <em>ranking</em>) on variables for whether students are eligible to the scholarship and pass the <em>Saber 11</em> exam in 2015 (variable <em>eligible_post</em>), on the running variable <em>sisben</em>, as well as on control variables. The coefficient of interest (variable <em>eligible_post</em>) gives the change in discontinuity in test scores before and after the introduction of SPP.</p>
<p>To do so, you will use the command <code>reg</code> and add the condition which states that the absolute value of the variable <em>sisben</em> must be inferior to the optimal bandwidth, as explained above.</p>
<div class="sourceCode" id="cb115" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb115-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb115-1" tabindex="-1"></a><span class="kw">reg</span> ranking eligible_post eligible <span class="kw">post</span> sisben sisben_eligible sisben_post sisben_eligible_post <span class="ot">${controls}</span> <span class="kw">if</span> <span class="fu">abs</span>(sisben)&lt;bw_dif_cersum, <span class="kw">robust</span></span></code></pre></div>
<p>Once the regression is estimated, use the command <code>outreg2</code> to report the regression outputs from Stata into Excel, Word, Latex or any other format. It gives you the type of presentation found in academic papers. To use it, you have to install the package <code>outreg2</code> first.</p>
<div class="sourceCode" id="cb116" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb116-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb116-1" tabindex="-1"></a><span class="kw">ssc</span> install outreg2</span>
<span id="cb116-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb116-2" tabindex="-1"></a>outreg2 <span class="kw">using</span> <span class="st">&quot;DIF_RD_main.xls&quot;</span>, addtext(Quantiles,<span class="st">&quot;OLS Dif RD&quot;</span>) ctitle(<span class="st">&quot;LATE&quot;</span>) less(1) <span class="kw">keep</span>(eligible_post) <span class="kw">nocons</span> <span class="kw">replace</span></span></code></pre></div>
<p>The option <code>less()</code> specifies how many less significant digits to be displayed for the auxiliary (non-coefficient) statistics.</p>
</div>
<div id="step-3---quantile-regressions-with-qreg-command" class="section level4 unnumbered hasAnchor">
<h4>Step 3 - Quantile regressions with qreg command<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#step-3---quantile-regressions-with-qreg-command" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For the quantile regressions, use the command <code>qreg</code> to run the regression, as before, the dependent <em>ranking</em> on variables of interest, the running variable, and on control variables. Though, in this case, the regression is performed with a loop <code>foreach</code> to repeat it for each quantile. Once again, you will have to specify the condition of eligibility and use a robust estimator of variance vce(r). To display the results for each quantile regression in an academic table, you can once again use the <code>outreg2</code> command in the loop.</p>
<p>However, before running the regression, you will have to set the maximum number of iterations to 1,000. Indeed, in quantile regression, the estimation procedure follows a numerical minimization procedure through the simplex method: the algorithm repeats computations (here set at 1000 repetitions) to find parameter estimates minimizing the loss objective function.</p>
<div class="sourceCode" id="cb117" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb117-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb117-1" tabindex="-1"></a><span class="kw">set</span> <span class="dv">maxiter</span> 1000</span>
<span id="cb117-2"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb117-2" tabindex="-1"></a></span>
<span id="cb117-3"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb117-3" tabindex="-1"></a><span class="kw">foreach</span> <span class="fu">q</span> <span class="kw">in</span> 25 50 75 90 {</span>
<span id="cb117-4"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb117-4" tabindex="-1"></a><span class="kw">qreg</span> ranking eligible_post eligible <span class="kw">post</span> sisben sisben_eligible sisben_post sisben_eligible_post  <span class="ot">${controls}if</span> <span class="fu">abs</span>(sisben)&lt;bw_dif_cersum , <span class="fu">q</span>(<span class="ot">`q&#39;</span>) <span class="kw">vce</span>(<span class="kw">robust</span>)  </span>
<span id="cb117-5"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb117-5" tabindex="-1"></a></span>
<span id="cb117-6"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb117-6" tabindex="-1"></a>outreg2 <span class="kw">using</span> <span class="st">&quot;DIF_RD_main.xls&quot;</span>, addtext(Quantiles,<span class="st">&quot;`q&#39; Dif RD&quot;</span>) ctitle(<span class="st">&quot;`q&#39;&quot;</span>) less(1) <span class="kw">keep</span>(eligible_post) <span class="kw">nocons</span> <span class="kw">append</span></span>
<span id="cb117-7"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb117-7" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="resources/LMS/image7.png" /></p>
<p><strong>How to read Table 3?</strong> Table 3 above shows that the introduction of the scholarship Ser Pilo Paga has non-significant effect on the <em>Saber 11</em> test scores at the mean, as well as at the 25th and 50th percentiles. However, looking at heterogeneity in the ranking, there are positive and statistically significant effects for the 75th and 90th percentiles, respectively. In other words, a significant gap reduction in test scores between eligible and non-eligible students can be observed at the top of the distribution of the ranking in test scores. The effect of the scholarship on the <em>Saber 11</em> ranking is around 1.5 rank for eligible students. These findings are in line with the Figure 4 replicated just above.</p>
</div>
</div>
<div id="robustness-check---replication-of-figure-a2" class="section level3 hasAnchor" number="4.1.6">
<h3><span class="header-section-number">4.1.6</span> Robustness check - Replication of Figure A2<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#robustness-check---replication-of-figure-a2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An important and interesting robustness check to conduct in RDD is to study the density of the running variable. This allows checking whether there are too many observations on one side of the cut-off compared to the other side. In other words, you want to verify whether individuals have manipulated the running variable in order to benefit from the program provided by the policy in place.</p>
<p><a href="https://EconPapers.repec.org/RePEc:eee:econom:v:142:y:2008:i:2:p:698-714" target="_blank">McCrary (2008)</a> was the first to introduce the idea of manipulation testing in the context of regression discontinuity (RD) designs.</p>
<p>In our case, the authors want to demonstrate that the <em>Sisbén</em> score has not been manipulated around the eligibility cutoff. To this end, they will test for discontinuity in observation densities around the cutoff. A cluster below the cutoff would suggest that households have manipulated their <em>Sisbén</em> score in order to qualify for the program, creating a selection effect and posing a serious problem in terms of unobservable differences between students on either side of the cutoff. This would make for a biased comparison between the two groups.</p>
<p>To test for that, you will replicate Figure A2 below. It should show no significant discontinuity in the <em>Sisbén</em> score density, when examining the three types of geographical areas taken into account by the Colombian statistics office: the 14 main cities, the other urban areas and the rural areas (each with a different cutoff).</p>
<p><img src="resources/LMS/image8.png" /></p>
<div id="test-for-manipulation-around-the-eligibility-cutoff-using-the-rddensity-package" class="section level4 hasAnchor" number="4.1.6.1">
<h4><span class="header-section-number">4.1.6.1</span> Test for manipulation around the eligibility cutoff using the rddensity package<a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#test-for-manipulation-around-the-eligibility-cutoff-using-the-rddensity-package" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To test for manipulation around the eligibility cutoff, the authors are using the local polynomial density estimation technique introduced by <a href="https://doi.org/10.1080/01621459.2019.1635480" target="_blank">Cattaneo et al. (2017)</a>.</p>
<p>To start, you will first have to find the p-value using the Cattaneo et al.’s method. For that, you will need to install the package <code>rddensity</code>. If the p-value is lower than 0.05, it suggests that there has been some manipulation.</p>
<div class="sourceCode" id="cb118" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb118-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb118-1" tabindex="-1"></a><span class="kw">ssc</span> install rddensity</span></code></pre></div>
<p>Since the year of interest for manipulation is 2015, set <code>keep if year == 2015</code>.</p>
<p>Then, run a regression discontinuity analysis, specifying a first-order polynomial (p(1)) around the cutoff point in the <em>sisben</em> variable for each of the sisben area. For example, to take into account the 14 largest Colombian cities, you have to set the variable <em>area_sisben=1</em>.</p>
<div class="sourceCode" id="cb119" language="Stata" numbers="none"><pre class="sourceCode Stata"><code class="sourceCode stata"><span id="cb119-1"><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#cb119-1" tabindex="-1"></a>rddensity sisben <span class="kw">if</span> area_sisben==1, <span class="kw">p</span>(1) </span></code></pre></div>
<p>You should see that these results are robust for the three types of geographical areas taken into account by the Colombian statistics office: the 14 main cities, the other urban areas and the rural areas (each with a different cutoff).</p>
<ul>
<li>p-value for 14 main cities: 0.3183</li>
<li>p-value for other urban areas: 0.7747</li>
<li>p-value for rural areas: 0.1285</li>
</ul>
<p>Indeed, all the three p-values are higher than 0.05.</p>
<p>Compared to the McCrary density test (2008) usually used so far, the technique of Cattaneo et al. (2017) avoids pre-binning the data and is constructed intuitively based on easy-to-interpret kernel functions.</p>
</div>
<div id="replication-of-the-chart-for-the-14-major-cities-then-for-urban-and-rural-using-twoway" class="section level4 hasAnchor" number="4.1.6.2">
<h4><span class="header-section-number">4.1.6.2</span> Replication of the chart for the 14 major cities, then for urban and rural using <code>twoway</code><a href="equality-of-opportunity-and-human-capital-accumulation-motivational-effect-of-a-nationwide-scholarship-in-colombia.html#replication-of-the-chart-for-the-14-major-cities-then-for-urban-and-rural-using-twoway" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To plot the discontinuity, use the command <code>twoway</code>, which is a basic command for graphs fitting Y on X and use the <code>histogram</code> function for the variable <em>score_sisben</em>.</p>
<p>At this step, you may:
- Choose the color of your histogram (here black (fcolor(black)) with gray outlines (bcolor(gray))),
- Place a red line to place the cutoff of the 14 main Colombian cities using the command scatteri,
- Add the p-value you got in the part A for each type of area (here for the 14 main cities 0.3183) at the lop left of the graph,
- Give the respective names <em>Sisbén</em> - Socioeconomic Index and Density to the X and Y axes and finally,
- Export the graph as .png file format</p>
<p>```{.Stata language=“Stata” numbers<em>=“none”}
</em>Replicate first graph of Figure A1
twoway(histogram score_sisben if area_sisben==1, fcolor(black) bcolor(gray)) ///
(scatteri 0 56.32 0.025 56.32 (9), c(l) m(i) color(red)), /// plots a single red line at coordinates (0.025, 56.32)
text(0.025 57.21 “14 Cities”, place(e) size(medium)) /// adds the text for the line
text(0.025 0 “P-Val=.3183”, place(e) size(medium)) /// adds the p-value at the top left of the graph
legend(off) xtitle(“{it:Sisbén} - Socioeconomic Index”) ylabel(0(.01).025) /// no legend, name of the var on the x- and y-axis
ytitle(“Density”) graphregion(style(none) color(gs16)) name(“histogram_14cities”, replace) // title</p>
<p>graph export “histogram_14cities.png”, replace // Exports the graph as a PNG file named “histogram_14cities1.png” to the directory specified</p>
<pre><code>
#### Combination and exportation of the three graphs together

```{.Stata language=&quot;Stata&quot; numbers=&quot;none&quot;}
graph combine histogram_14cities histogram_urban histogram_rural, ///
    rows(3) graphregion(style(none) color(gs16)) ///
    imargin(medsmall) xcommon ycommon

graph export&quot;figure_A2.png&quot;, replace</code></pre>
<hr />
<p><strong>Authors:</strong> Angélique FANTOU, Agathe LOYER, Emma VERHILLE, students in the <a href="https://economie-master-developmenteconomics.pantheonsorbonne.fr/" target="_blank">Master program in Development Economics and Sustainable Development</a> (2023-2024), Sorbonne School of Economics, Université Paris 1 Panthéon Sorbonne.</p>
<p><strong>Date:</strong> December 2023</p>

</div>
</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="differences-in-discontinuity-design.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/SorbonneDevEcon/M2-Econometrics-Book/edit/main/05-Chapter5.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/SorbonneDevEcon/M2-Econometrics-Book/blob/main/05-Chapter5.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
